# --------------------------------------------------------------------
# FILE
#   Makefile.security.inc
#
# CONFIDENTIAL
#   Copyright (C) Cambridge Silicon Radio Ltd 2006-2007. All rights reserved.
#
# DESCRIPTION
#   Automatically defines the correct CRYPTO #defines based on the CSR_WIFI_SECURITY defines  
#
# REVISION
#   $Id: //depot/dot11/v7.0p/host/lib_crypto/Makefile.security.inc#1 $
#
# --------------------------------------------------------------------

ifneq (,$(findstring -DCSR_WIFI_SECURITY_WPA_PERSONAL_SUPPLICANT_ENABLE,$(CFG_DEFINES)))
CFG_DEFINES += -DCSR_CRYPTO_AES_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_HMAC_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_SHA1_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_MD5_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_RC4_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_PASSPHRASE_HASHING_ENABLE
endif

ifneq (,$(findstring -DCSR_WIFI_SECURITY_WPA_PERSONAL_AUTHENTICATOR_ENABLE,$(CFG_DEFINES)))
CFG_DEFINES += -DCSR_CRYPTO_HMAC_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_SHA1_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_MD5_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_AES_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_PASSPHRASE_HASHING_ENABLE
endif

ifneq (,$(findstring -DCSR_WIFI_SECURITY_FAST_ENABLE,$(CFG_DEFINES)))
CFG_DEFINES += -DCSR_CRYPTO_AES_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_ASN1_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_BN_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_DES_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_DH_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_HMAC_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_MD4_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_MD5_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_MSCHAP_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_RC4_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_SHA1_ENABLE
endif

ifneq (,$(findstring -DCSR_WIFI_SECURITY_TTLS_ENABLE,$(CFG_DEFINES)))
CFG_DEFINES += -DCSR_CRYPTO_MSCHAP_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_MD4_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_AES_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_ASN1_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_BN_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_DES_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_HMAC_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_MD5_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_RC4_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_SHA1_ENABLE
endif

ifneq (,$(findstring -DCSR_WIFI_SECURITY_TLS_ENABLE,$(CFG_DEFINES)))
CFG_DEFINES += -DCSR_CRYPTO_AES_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_ASN1_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_BN_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_DES_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_HMAC_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_MD5_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_RC4_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_SHA1_ENABLE
endif

ifneq (,$(findstring -DCSR_WIFI_SECURITY_LEAP_ENABLE,$(CFG_DEFINES)))
CFG_DEFINES += -DCSR_CRYPTO_DES_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_MD4_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_MD5_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_MSCHAP_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_SHA1_ENABLE
endif

ifneq (,$(findstring -DCSR_WIFI_SECURITY_WPS_ENABLE,$(CFG_DEFINES)))
CFG_DEFINES += -DCSR_CRYPTO_AES_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_BN_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_HMAC_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_SHA256_ENABLE
endif

ifneq (,$(findstring -DCSR_WIFI_SECURITY_WAPI_ENABLE,$(CFG_DEFINES)))
CFG_DEFINES += -DCSR_CRYPTO_PASSPHRASE_HASHING_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_ASN1_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_EC_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_BN_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_HMAC_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_KDHMACSHA256_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_SHA1_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_SHA256_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_SMS4_ENABLE
endif

ifneq (,$(findstring -DCSR_CRYPTO_PASSPHRASE_HASHING_ENABLE,$(CFG_DEFINES)))
CFG_DEFINES += -DCSR_CRYPTO_HMAC_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_SHA1_ENABLE
endif

ifneq (,$(findstring -DCSR_CRYPTO_PASSPHRASE_HASHING_ENABLE,$(CFG_DEFINES)))
CFG_DEFINES += -DCSR_CRYPTO_HMAC_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_SHA1_ENABLE
endif

ifneq (,$(findstring -DCSR_WIFI_SECURITY_SIM_ENABLE,$(CFG_DEFINES)))
CFG_DEFINES += -DCSR_CRYPTO_AES_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_ASN1_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_BN_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_DES_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_HMAC_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_MD5_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_RC4_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_SHA1_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_TLS_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_BN_ENABLE
endif


ifneq (,$(findstring -DCSR_WIFI_SECURITY_PMK_CACHING_ENABLE,$(CFG_DEFINES)))
CFG_DEFINES += -DCSR_CRYPTO_HMAC_ENABLE
CFG_DEFINES += -DCSR_CRYPTO_SHA1_ENABLE
endif


# Remove Duplicate defines
CFG_DEFINES := $(sort $(CFG_DEFINES))
