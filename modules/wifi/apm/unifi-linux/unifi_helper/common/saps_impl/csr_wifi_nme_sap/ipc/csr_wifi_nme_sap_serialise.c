/* This is an autogenerated file */
/* Tag: noCheckHeader */

/*    CONFIDENTIAL */
/*    Copyright (C) Cambridge Silicon Radio Ltd 2008. All rights reserved. */

#include "nme_top_level_fsm/nme_top_level_fsm.h"
#include "event_pack_unpack/event_pack_unpack.h"

CsrUint16 serialise_unifi_nme_association_complete_ind(CsrUint8** resultBuffer, CsrUint16 appHandlesCount, void* *appHandles, unifi_Status status, const unifi_ConnectionInfo *connectionInfo, unifi_IEEE80211Reason deauthReason)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 2;
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedSize += 4;
        }
    }
    packedSize += 1;
    packedSize += 32;
    packedSize += 1;
    packedSize += 6;
    packedSize += 1;
    packedSize += 1;
    packedSize += 2;
    packedSize += 2;
    packedSize += 2;
    packedSize += 2;
    packedSize += 1;
    packedSize += 2;
    packedSize += 2;
    packedSize += 2;
    packedSize += 2;
    if (connectionInfo->beaconFrameLength)
    {
        packedSize += connectionInfo->beaconFrameLength;
    }
    packedSize += 2;
    if (connectionInfo->associationReqFrameLength)
    {
        packedSize += connectionInfo->associationReqFrameLength;
    }
    packedSize += 2;
    if (connectionInfo->associationRspFrameLength)
    {
        packedSize += connectionInfo->associationRspFrameLength;
    }
    packedSize += 2;
    if (connectionInfo->assocScanInfoElementsLength)
    {
        packedSize += connectionInfo->assocScanInfoElementsLength;
    }
    packedSize += 2;
    packedSize += 2;
    packedSize += 6;
    packedSize += 2;
    if (connectionInfo->assocReqInfoElementsLength)
    {
        packedSize += connectionInfo->assocReqInfoElementsLength;
    }
    packedSize += 2;
    packedSize += 2;
    packedSize += 2;
    packedSize += 2;
    if (connectionInfo->assocRspInfoElementsLength)
    {
        packedSize += connectionInfo->assocRspInfoElementsLength;
    }
    packedSize += 2;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_ASSOCIATION_COMPLETE_IND_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, appHandlesCount);
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandles[i1]);
        }
    }
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);
    packedLength += event_pack_buffer(&buffer, connectionInfo->ssid.ssid, 32);
    packedLength += event_pack_CsrUint8(&buffer, connectionInfo->ssid.length);
    packedLength += event_pack_buffer(&buffer, connectionInfo->bssid.data, 6);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)connectionInfo->networkType80211);
    packedLength += event_pack_CsrUint8(&buffer, connectionInfo->channelNumber);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->channelFrequency);
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)connectionInfo->authMode);
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)connectionInfo->pairwiseCipher);
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)connectionInfo->groupCipher);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)connectionInfo->ifIndex);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->atimWindowTu);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->beaconPeriodTu);
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)connectionInfo->reassociation);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->beaconFrameLength);
    if (connectionInfo->beaconFrameLength)
    {
        packedLength += event_pack_buffer(&buffer, connectionInfo->beaconFrame, connectionInfo->beaconFrameLength);
    }
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->associationReqFrameLength);
    if (connectionInfo->associationReqFrameLength)
    {
        packedLength += event_pack_buffer(&buffer, connectionInfo->associationReqFrame, connectionInfo->associationReqFrameLength);
    }
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->associationRspFrameLength);
    if (connectionInfo->associationRspFrameLength)
    {
        packedLength += event_pack_buffer(&buffer, connectionInfo->associationRspFrame, connectionInfo->associationRspFrameLength);
    }
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->assocScanInfoElementsLength);
    if (connectionInfo->assocScanInfoElementsLength)
    {
        packedLength += event_pack_buffer(&buffer, connectionInfo->assocScanInfoElements, connectionInfo->assocScanInfoElementsLength);
    }
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->assocReqCapabilities);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->assocReqListenIntervalBeacons);
    packedLength += event_pack_buffer(&buffer, connectionInfo->assocReqApAddress.data, 6);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->assocReqInfoElementsLength);
    if (connectionInfo->assocReqInfoElementsLength)
    {
        packedLength += event_pack_buffer(&buffer, connectionInfo->assocReqInfoElements, connectionInfo->assocReqInfoElementsLength);
    }
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)connectionInfo->assocRspResult);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->assocRspCapabilityInfo);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->assocRspAssociationId);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->assocRspInfoElementsLength);
    if (connectionInfo->assocRspInfoElementsLength)
    {
        packedLength += event_pack_buffer(&buffer, connectionInfo->assocRspInfoElements, connectionInfo->assocRspInfoElementsLength);
    }
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)deauthReason);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_association_start_ind(CsrUint8** resultBuffer, CsrUint16 appHandlesCount, void* *appHandles, const unifi_MACAddress *address, const unifi_SSID *ssid)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 2;
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedSize += 4;
        }
    }
    packedSize += 6;
    packedSize += 32;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_ASSOCIATION_START_IND_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, appHandlesCount);
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandles[i1]);
        }
    }
    packedLength += event_pack_buffer(&buffer, address->data, 6);
    packedLength += event_pack_buffer(&buffer, ssid->ssid, 32);
    packedLength += event_pack_CsrUint8(&buffer, ssid->length);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_blacklist_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status, unifi_ListAction action, CsrUint8 getAddressCount, const unifi_MACAddress *getAddresses)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;
    packedSize += 1;
    packedSize += 1;
    if (getAddressCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < getAddressCount; i1++)
        {
            packedSize += 6;
        }
    }

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_BLACKLIST_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)action);
    packedLength += event_pack_CsrUint8(&buffer, getAddressCount);
    if (getAddressCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < getAddressCount; i1++)
        {
            packedLength += event_pack_buffer(&buffer, getAddresses[i1].data, 6);
        }
    }

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_certificate_validate_ind(CsrUint8** resultBuffer, CsrUint16 appHandlesCount, void* *appHandles, CsrUint8 validationId, CsrUint32 certificateLength, const CsrUint8 *certificate)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 2;
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedSize += 4;
        }
    }
    packedSize += 1;
    packedSize += 4;
    if (certificateLength)
    {
        packedSize += certificateLength;
    }

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_CERTIFICATE_VALIDATE_IND_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, appHandlesCount);
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandles[i1]);
        }
    }
    packedLength += event_pack_CsrUint8(&buffer, validationId);
    packedLength += event_pack_CsrUint32(&buffer, certificateLength);
    if (certificateLength)
    {
        packedLength += event_pack_buffer(&buffer, certificate, certificateLength);
    }

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_connect_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_CONNECT_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_connection_quality_ind(CsrUint8** resultBuffer, CsrUint16 appHandlesCount, void* *appHandles, const unifi_LinkQuality *linkQuality)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 2;
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedSize += 4;
        }
    }
    packedSize += 2;
    packedSize += 2;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_CONNECTION_QUALITY_IND_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, appHandlesCount);
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandles[i1]);
        }
    }
    packedLength += event_pack_CsrInt16(&buffer, linkQuality->unifiRssi);
    packedLength += event_pack_CsrInt16(&buffer, linkQuality->unifiSnr);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_connection_status_get_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status, unifi_ConnectionStatus connectionStatus)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_CONNECTION_STATUS_GET_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)connectionStatus);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_disconnect_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_DISCONNECT_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_event_mask_set_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_EVENT_MASK_SET_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_get_value_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status, const unifi_AppValue *appValue)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;
    packedSize += 1;
    switch(appValue->id)
    {
    case unifi_CloakedSsidConfigValue:
        packedSize += 1;
        if (appValue->unifi_Value_union.cloakedSsids.cloakedSsidsCount)
        {
            CsrUint16 i4;
            for(i4 = 0; i4 < appValue->unifi_Value_union.cloakedSsids.cloakedSsidsCount; i4++)
            {
                packedSize += 32;
                packedSize += 1;
            }
        }
        break;
    case unifi_ScanConfigValue:
        {
        CsrUint16 i4;
        for(i4 = 0; i4 < 4; i4++)
        {
            packedSize += 2;
            packedSize += 2;
            packedSize += 2;
            packedSize += 2;
            packedSize += 2;
            packedSize += 2;
        }
        }
        packedSize += 2;
        packedSize += 2;
        packedSize += 1;
        packedSize += 1;
        packedSize += 1;
        packedSize += 1;
        packedSize += 1;
        packedSize += 1;
        packedSize += 2;
        if (appValue->unifi_Value_union.scanConfig.passiveChannelListCount)
        {
            packedSize += appValue->unifi_Value_union.scanConfig.passiveChannelListCount;
        }
        break;
    case unifi_RegulatoryDomainInfoValue:
        packedSize += 2;
        packedSize += 2;
        packedSize += 1;
        packedSize += 2;
        break;
    case unifi_SmeConfigValue:
        packedSize += 1;
        packedSize += 1;
        packedSize += 1;
        packedSize += 2;
        packedSize += 1;
        packedSize += 1;
        packedSize += 1;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        break;
    case unifi_VersionsValue:
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += (CsrUint16)(CsrStrLen(appValue->unifi_Value_union.versions.smeIdString) + 3);
        break;
    case unifi_CoexConfigValue:
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        packedSize += 1;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        break;
    case unifi_LinkQualityValue:
        packedSize += 2;
        packedSize += 2;
        break;
    case unifi_StationMACAddressValue:
        packedSize += 6;
        break;
    case unifi_MibConfigValue:
        packedSize += 2;
        packedSize += 1;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        break;
    case unifi_PermanentMACAddressValue:
        packedSize += 6;
        break;
    case unifi_ConnectionStatsValue:
        packedSize += 1;
        packedSize += 1;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        packedSize += 4;
        break;
    case unifi_RoamingConfigValue:
        {
        CsrUint16 i4;
        for(i4 = 0; i4 < 3; i4++)
        {
            packedSize += 2;
            packedSize += 2;
            packedSize += 2;
            packedSize += 2;
            packedSize += 4;
            packedSize += 4;
            packedSize += 1;
            packedSize += 1;
            packedSize += 1;
            packedSize += 1;
            packedSize += 1;
            packedSize += 1;
        }
        }
        packedSize += 1;
        packedSize += 1;
        packedSize += 1;
        packedSize += 1;
        packedSize += 2;
        packedSize += 1;
        {
        CsrUint16 i4;
        for(i4 = 0; i4 < 3; i4++)
        {
            packedSize += 2;
            packedSize += 2;
            packedSize += 2;
            packedSize += 2;
            packedSize += 2;
            packedSize += 2;
        }
        }
        break;
    case unifi_AdHocConfigValue:
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        break;
    case unifi_ConnectionInfoValue:
        packedSize += 32;
        packedSize += 1;
        packedSize += 6;
        packedSize += 1;
        packedSize += 1;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        packedSize += 1;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        if (appValue->unifi_Value_union.connectionInfo.beaconFrameLength)
        {
            packedSize += appValue->unifi_Value_union.connectionInfo.beaconFrameLength;
        }
        packedSize += 2;
        if (appValue->unifi_Value_union.connectionInfo.associationReqFrameLength)
        {
            packedSize += appValue->unifi_Value_union.connectionInfo.associationReqFrameLength;
        }
        packedSize += 2;
        if (appValue->unifi_Value_union.connectionInfo.associationRspFrameLength)
        {
            packedSize += appValue->unifi_Value_union.connectionInfo.associationRspFrameLength;
        }
        packedSize += 2;
        if (appValue->unifi_Value_union.connectionInfo.assocScanInfoElementsLength)
        {
            packedSize += appValue->unifi_Value_union.connectionInfo.assocScanInfoElementsLength;
        }
        packedSize += 2;
        packedSize += 2;
        packedSize += 6;
        packedSize += 2;
        if (appValue->unifi_Value_union.connectionInfo.assocReqInfoElementsLength)
        {
            packedSize += appValue->unifi_Value_union.connectionInfo.assocReqInfoElementsLength;
        }
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        if (appValue->unifi_Value_union.connectionInfo.assocRspInfoElementsLength)
        {
            packedSize += appValue->unifi_Value_union.connectionInfo.assocRspInfoElementsLength;
        }
        break;
    case unifi_CoexInfoValue:
        packedSize += 2;
        packedSize += 1;
        packedSize += 2;
        packedSize += 1;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        packedSize += 4;
        packedSize += 4;
        packedSize += 1;
        break;
    case unifi_CalibrationDataValue:
        packedSize += 2;
        if (appValue->unifi_Value_union.calibrationData.length)
        {
            packedSize += appValue->unifi_Value_union.calibrationData.length;
        }
        break;
    case unifi_ConnectionConfigValue:
        packedSize += 32;
        packedSize += 1;
        packedSize += 6;
        packedSize += 1;
        packedSize += 1;
        packedSize += 1;
        packedSize += 2;
        packedSize += 2;
        packedSize += 2;
        if (appValue->unifi_Value_union.connectionConfig.mlmeAssociateReqInformationElementsLength)
        {
            packedSize += appValue->unifi_Value_union.connectionConfig.mlmeAssociateReqInformationElementsLength;
        }
        packedSize += 1;
        packedSize += 2;
        packedSize += 1;
        break;
    case unifi_CcxConfigValue:
        packedSize += 1;
        packedSize += 2;
        packedSize += 1;
        packedSize += 2;
        break;
    case unifi_PowerConfigValue:
        packedSize += 1;
        packedSize += 2;
        packedSize += 2;
        packedSize += 1;
        break;
    case unifi_HostConfigValue:
        packedSize += 1;
        packedSize += 2;
        break;
    default:
        break;
    };

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_GET_VALUE_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->id);
    switch(appValue->id)
    {
    case unifi_CloakedSsidConfigValue:
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.cloakedSsids.cloakedSsidsCount);
        if (appValue->unifi_Value_union.cloakedSsids.cloakedSsidsCount)
        {
            CsrUint16 i4;
            for(i4 = 0; i4 < appValue->unifi_Value_union.cloakedSsids.cloakedSsidsCount; i4++)
            {
                packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.cloakedSsids.cloakedSsids[i4].ssid, 32);
                packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.cloakedSsids.cloakedSsids[i4].length);
            }
        }
        break;
    case unifi_ScanConfigValue:
        {
        CsrUint16 i4;
        for(i4 = 0; i4 < 4; i4++)
        {
            packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.scanConfig.scanCfg[i4].intervalSeconds);
            packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.scanConfig.scanCfg[i4].validitySeconds);
            packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.scanConfig.scanCfg[i4].minActiveChannelTimeTu);
            packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.scanConfig.scanCfg[i4].maxActiveChannelTimeTu);
            packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.scanConfig.scanCfg[i4].minPassiveChannelTimeTu);
            packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.scanConfig.scanCfg[i4].maxPassiveChannelTimeTu);
        }
        }
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.scanConfig.disableAutonomousScans);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.scanConfig.maxResults);
        packedLength += event_pack_CsrInt8(&buffer, appValue->unifi_Value_union.scanConfig.highRSSIThreshold);
        packedLength += event_pack_CsrInt8(&buffer, appValue->unifi_Value_union.scanConfig.lowRSSIThreshold);
        packedLength += event_pack_CsrInt8(&buffer, appValue->unifi_Value_union.scanConfig.deltaRSSIThreshold);
        packedLength += event_pack_CsrInt8(&buffer, appValue->unifi_Value_union.scanConfig.highSNRThreshold);
        packedLength += event_pack_CsrInt8(&buffer, appValue->unifi_Value_union.scanConfig.lowSNRThreshold);
        packedLength += event_pack_CsrInt8(&buffer, appValue->unifi_Value_union.scanConfig.deltaSNRThreshold);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.scanConfig.passiveChannelListCount);
        if (appValue->unifi_Value_union.scanConfig.passiveChannelListCount)
        {
            packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.scanConfig.passiveChannelList, appValue->unifi_Value_union.scanConfig.passiveChannelListCount);
        }
        break;
    case unifi_RegulatoryDomainInfoValue:
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.regDomInfo.dot11MultiDomainCapabilityImplemented);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.regDomInfo.dot11MultiDomainCapabilityEnabled);
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.regDomInfo.currentRegulatoryDomain);
        packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.regDomInfo.currentCountryCode, 2);
        break;
    case unifi_SmeConfigValue:
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.smeConfig.connectionQualityRssiChangeTrigger);
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.smeConfig.connectionQualitySnrChangeTrigger);
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.smeConfig.trustLevel);
        packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.smeConfig.countryCode, 2);
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.smeConfig.wmmModeMask);
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.smeConfig.ifIndex);
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.smeConfig.firmwareDriverInterface);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.smeConfig.allowUnicastUseGroupCipher);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.smeConfig.enableRestrictedAccess);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.smeConfig.enableStrictDraftN);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.smeConfig.enableOpportunisticKeyCaching);
        break;
    case unifi_VersionsValue:
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.versions.chipId);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.versions.chipVersion);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.versions.firmwareBuild);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.versions.firmwarePatch);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.versions.firmwareHip);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.versions.driverBuild);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.versions.driverHip);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.versions.smeBuild);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.versions.smeVariant);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.versions.smeHip);
        packedLength += event_pack_string(&buffer, appValue->unifi_Value_union.versions.smeIdString);
        break;
    case unifi_CoexConfigValue:
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.coexConfig.coexEnable);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.coexConfig.coexAfhChannelEnable);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.coexConfig.coexAdvancedEnable);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.coexConfig.coexEnableSchemeManagement);
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.coexConfig.coexDirection);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.coexConfig.coexPeriodicWakeHost);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.coexConfig.coexTrafficBurstyLatencyMs);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.coexConfig.coexTrafficContinuousLatencyMs);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.coexConfig.coexObexBlackoutDurationMs);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.coexConfig.coexObexBlackoutPeriodMs);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.coexConfig.coexA2dpBlackoutDurationMs);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.coexConfig.coexA2dpBlackoutPeriodMs);
        break;
    case unifi_LinkQualityValue:
        packedLength += event_pack_CsrInt16(&buffer, appValue->unifi_Value_union.linkQuality.unifiRssi);
        packedLength += event_pack_CsrInt16(&buffer, appValue->unifi_Value_union.linkQuality.unifiSnr);
        break;
    case unifi_StationMACAddressValue:
        packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.stationMacAddress.data, 6);
        break;
    case unifi_MibConfigValue:
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.mibConfig.unifiFixMaxTxDataRate);
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.mibConfig.unifiFixTxDataRate);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.mibConfig.dot11RtsThreshold);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.mibConfig.dot11FragmentationThreshold);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.mibConfig.dot11CurrentTxPowerLevel);
        break;
    case unifi_PermanentMACAddressValue:
        packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.permanentMacAddress.data, 6);
        break;
    case unifi_ConnectionStatsValue:
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.connectionStats.unifiTxDataRate);
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.connectionStats.unifiRxDataRate);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11RetryCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11MultipleRetryCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11AckFailureCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11FrameDuplicateCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11FcsErrorCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11RtsSuccessCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11RtsFailureCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11FailedCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11TransmittedFragmentCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11TransmittedFrameCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11WEPExcludedCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11WEPICVErrorCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11WEPUndecryptableCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11MulticastReceivedFrameCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11MulticastTransmittedFrameCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11ReceivedFragmentCount);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11RSNA4WayHandshakeFailures);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11RSNATKIPCounterMeasuresInvoked);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11RSNAStatsTKIPLocalMICFailures);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11RSNAStatsTKIPReplays);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11RSNAStatsTKIPICVErrors);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11RSNAStatsCCMPReplays);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.connectionStats.dot11RSNAStatsCCMPDecryptErrors);
        break;
    case unifi_RoamingConfigValue:
        {
        CsrUint16 i4;
        for(i4 = 0; i4 < 3; i4++)
        {
            packedLength += event_pack_CsrInt16(&buffer, appValue->unifi_Value_union.roamingConfig.roamingBands[i4].rssiHighThreshold);
            packedLength += event_pack_CsrInt16(&buffer, appValue->unifi_Value_union.roamingConfig.roamingBands[i4].rssiLowThreshold);
            packedLength += event_pack_CsrInt16(&buffer, appValue->unifi_Value_union.roamingConfig.roamingBands[i4].snrHighThreshold);
            packedLength += event_pack_CsrInt16(&buffer, appValue->unifi_Value_union.roamingConfig.roamingBands[i4].snrLowThreshold);
            packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.roamingConfig.roamingBands[i4].monitorInterval);
            packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.roamingConfig.roamingBands[i4].monitorWindow);
            packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.roamingConfig.roamingBands[i4].dot11RetryRatio);
            packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.roamingConfig.roamingBands[i4].dot11MultipleRetryRatio);
            packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.roamingConfig.roamingBands[i4].dot11AckFailureRatio);
            packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.roamingConfig.roamingBands[i4].dot11FcsErrorRatio);
            packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.roamingConfig.roamingBands[i4].dot11RtsFailureRatio);
            packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.roamingConfig.roamingBands[i4].beaconLossThreshold);
        }
        }
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.roamingConfig.lowQualHystWindow);
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.roamingConfig.apBlockTimeMs);
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.roamingConfig.roamMonitorPeriodMs);
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.roamingConfig.roamNumMaxTh);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.roamingConfig.disableRoamScans);
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.roamingConfig.reconnectLimit);
        {
        CsrUint16 i4;
        for(i4 = 0; i4 < 3; i4++)
        {
            packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.roamingConfig.roamScanCfg[i4].intervalSeconds);
            packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.roamingConfig.roamScanCfg[i4].validitySeconds);
            packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.roamingConfig.roamScanCfg[i4].minActiveChannelTimeTu);
            packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.roamingConfig.roamScanCfg[i4].maxActiveChannelTimeTu);
            packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.roamingConfig.roamScanCfg[i4].minPassiveChannelTimeTu);
            packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.roamingConfig.roamScanCfg[i4].maxPassiveChannelTimeTu);
        }
        }
        break;
    case unifi_AdHocConfigValue:
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.adHocConfig.atimWindowTu);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.adHocConfig.beaconPeriodTu);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.adHocConfig.joinOnlyAttempts);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.adHocConfig.joinAttemptIntervalMs);
        break;
    case unifi_ConnectionInfoValue:
        packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.connectionInfo.ssid.ssid, 32);
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.connectionInfo.ssid.length);
        packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.connectionInfo.bssid.data, 6);
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.connectionInfo.networkType80211);
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.connectionInfo.channelNumber);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionInfo.channelFrequency);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.connectionInfo.authMode);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.connectionInfo.pairwiseCipher);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.connectionInfo.groupCipher);
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.connectionInfo.ifIndex);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionInfo.atimWindowTu);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionInfo.beaconPeriodTu);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.connectionInfo.reassociation);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionInfo.beaconFrameLength);
        if (appValue->unifi_Value_union.connectionInfo.beaconFrameLength)
        {
            packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.connectionInfo.beaconFrame, appValue->unifi_Value_union.connectionInfo.beaconFrameLength);
        }
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionInfo.associationReqFrameLength);
        if (appValue->unifi_Value_union.connectionInfo.associationReqFrameLength)
        {
            packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.connectionInfo.associationReqFrame, appValue->unifi_Value_union.connectionInfo.associationReqFrameLength);
        }
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionInfo.associationRspFrameLength);
        if (appValue->unifi_Value_union.connectionInfo.associationRspFrameLength)
        {
            packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.connectionInfo.associationRspFrame, appValue->unifi_Value_union.connectionInfo.associationRspFrameLength);
        }
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionInfo.assocScanInfoElementsLength);
        if (appValue->unifi_Value_union.connectionInfo.assocScanInfoElementsLength)
        {
            packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.connectionInfo.assocScanInfoElements, appValue->unifi_Value_union.connectionInfo.assocScanInfoElementsLength);
        }
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionInfo.assocReqCapabilities);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionInfo.assocReqListenIntervalBeacons);
        packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.connectionInfo.assocReqApAddress.data, 6);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionInfo.assocReqInfoElementsLength);
        if (appValue->unifi_Value_union.connectionInfo.assocReqInfoElementsLength)
        {
            packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.connectionInfo.assocReqInfoElements, appValue->unifi_Value_union.connectionInfo.assocReqInfoElementsLength);
        }
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.connectionInfo.assocRspResult);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionInfo.assocRspCapabilityInfo);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionInfo.assocRspAssociationId);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionInfo.assocRspInfoElementsLength);
        if (appValue->unifi_Value_union.connectionInfo.assocRspInfoElementsLength)
        {
            packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.connectionInfo.assocRspInfoElements, appValue->unifi_Value_union.connectionInfo.assocRspInfoElementsLength);
        }
        break;
    case unifi_CoexInfoValue:
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.coexInfo.hasTrafficData);
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.coexInfo.currentTrafficType);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.coexInfo.currentPeriodMs);
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.coexInfo.currentPowerSave);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.coexInfo.currentCoexPeriodMs);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.coexInfo.currentCoexLatencyMs);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.coexInfo.hasBtDevice);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.coexInfo.currentBlackoutDurationUs);
        packedLength += event_pack_CsrUint32(&buffer, appValue->unifi_Value_union.coexInfo.currentBlackoutPeriodUs);
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.coexInfo.currentCoexScheme);
        break;
    case unifi_CalibrationDataValue:
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.calibrationData.length);
        if (appValue->unifi_Value_union.calibrationData.length)
        {
            packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.calibrationData.data, appValue->unifi_Value_union.calibrationData.length);
        }
        break;
    case unifi_ConnectionConfigValue:
        packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.connectionConfig.ssid.ssid, 32);
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.connectionConfig.ssid.length);
        packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.connectionConfig.bssid.data, 6);
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.connectionConfig.bssType);
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.connectionConfig.ifIndex);
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.connectionConfig.privacyMode);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionConfig.authModeMask);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionConfig.encryptionModeMask);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.connectionConfig.mlmeAssociateReqInformationElementsLength);
        if (appValue->unifi_Value_union.connectionConfig.mlmeAssociateReqInformationElementsLength)
        {
            packedLength += event_pack_buffer(&buffer, appValue->unifi_Value_union.connectionConfig.mlmeAssociateReqInformationElements, appValue->unifi_Value_union.connectionConfig.mlmeAssociateReqInformationElementsLength);
        }
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.connectionConfig.wmmQosInfo);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.connectionConfig.adhocJoinOnly);
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.connectionConfig.adhocChannel);
        break;
    case unifi_CcxConfigValue:
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.ccxConfig.keepAliveTimeMs);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.ccxConfig.apRoamingEnabled);
        packedLength += event_pack_CsrUint8(&buffer, appValue->unifi_Value_union.ccxConfig.measurementsMask);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.ccxConfig.ccxRadioMgtEnabled);
        break;
    case unifi_PowerConfigValue:
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.powerConfig.powerSaveLevel);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.powerConfig.listenIntervalBeacons);
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)appValue->unifi_Value_union.powerConfig.rxDtims);
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.powerConfig.d3AutoScanMode);
        break;
    case unifi_HostConfigValue:
        packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValue->unifi_Value_union.hostConfig.powerMode);
        packedLength += event_pack_CsrUint16(&buffer, appValue->unifi_Value_union.hostConfig.applicationDataPeriodMs);
        break;
    default:
        break;
    };

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_ibss_station_ind(CsrUint8** resultBuffer, CsrUint16 appHandlesCount, void* *appHandles, const unifi_MACAddress *address, CsrBool isconnected)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 2;
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedSize += 4;
        }
    }
    packedSize += 6;
    packedSize += 2;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_IBSS_STATION_IND_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, appHandlesCount);
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandles[i1]);
        }
    }
    packedLength += event_pack_buffer(&buffer, address->data, 6);
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)isconnected);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_key_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status, unifi_ListAction action)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_KEY_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)action);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_media_status_ind(CsrUint8** resultBuffer, CsrUint16 appHandlesCount, void* *appHandles, unifi_MediaStatus mediaStatus, const unifi_ConnectionInfo *connectionInfo, unifi_IEEE80211Reason disassocReason, unifi_IEEE80211Reason deauthReason)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 2;
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedSize += 4;
        }
    }
    packedSize += 1;
    packedSize += 32;
    packedSize += 1;
    packedSize += 6;
    packedSize += 1;
    packedSize += 1;
    packedSize += 2;
    packedSize += 2;
    packedSize += 2;
    packedSize += 2;
    packedSize += 1;
    packedSize += 2;
    packedSize += 2;
    packedSize += 2;
    packedSize += 2;
    if (connectionInfo->beaconFrameLength)
    {
        packedSize += connectionInfo->beaconFrameLength;
    }
    packedSize += 2;
    if (connectionInfo->associationReqFrameLength)
    {
        packedSize += connectionInfo->associationReqFrameLength;
    }
    packedSize += 2;
    if (connectionInfo->associationRspFrameLength)
    {
        packedSize += connectionInfo->associationRspFrameLength;
    }
    packedSize += 2;
    if (connectionInfo->assocScanInfoElementsLength)
    {
        packedSize += connectionInfo->assocScanInfoElementsLength;
    }
    packedSize += 2;
    packedSize += 2;
    packedSize += 6;
    packedSize += 2;
    if (connectionInfo->assocReqInfoElementsLength)
    {
        packedSize += connectionInfo->assocReqInfoElementsLength;
    }
    packedSize += 2;
    packedSize += 2;
    packedSize += 2;
    packedSize += 2;
    if (connectionInfo->assocRspInfoElementsLength)
    {
        packedSize += connectionInfo->assocRspInfoElementsLength;
    }
    packedSize += 2;
    packedSize += 2;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_MEDIA_STATUS_IND_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, appHandlesCount);
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandles[i1]);
        }
    }
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)mediaStatus);
    packedLength += event_pack_buffer(&buffer, connectionInfo->ssid.ssid, 32);
    packedLength += event_pack_CsrUint8(&buffer, connectionInfo->ssid.length);
    packedLength += event_pack_buffer(&buffer, connectionInfo->bssid.data, 6);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)connectionInfo->networkType80211);
    packedLength += event_pack_CsrUint8(&buffer, connectionInfo->channelNumber);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->channelFrequency);
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)connectionInfo->authMode);
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)connectionInfo->pairwiseCipher);
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)connectionInfo->groupCipher);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)connectionInfo->ifIndex);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->atimWindowTu);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->beaconPeriodTu);
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)connectionInfo->reassociation);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->beaconFrameLength);
    if (connectionInfo->beaconFrameLength)
    {
        packedLength += event_pack_buffer(&buffer, connectionInfo->beaconFrame, connectionInfo->beaconFrameLength);
    }
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->associationReqFrameLength);
    if (connectionInfo->associationReqFrameLength)
    {
        packedLength += event_pack_buffer(&buffer, connectionInfo->associationReqFrame, connectionInfo->associationReqFrameLength);
    }
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->associationRspFrameLength);
    if (connectionInfo->associationRspFrameLength)
    {
        packedLength += event_pack_buffer(&buffer, connectionInfo->associationRspFrame, connectionInfo->associationRspFrameLength);
    }
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->assocScanInfoElementsLength);
    if (connectionInfo->assocScanInfoElementsLength)
    {
        packedLength += event_pack_buffer(&buffer, connectionInfo->assocScanInfoElements, connectionInfo->assocScanInfoElementsLength);
    }
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->assocReqCapabilities);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->assocReqListenIntervalBeacons);
    packedLength += event_pack_buffer(&buffer, connectionInfo->assocReqApAddress.data, 6);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->assocReqInfoElementsLength);
    if (connectionInfo->assocReqInfoElementsLength)
    {
        packedLength += event_pack_buffer(&buffer, connectionInfo->assocReqInfoElements, connectionInfo->assocReqInfoElementsLength);
    }
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)connectionInfo->assocRspResult);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->assocRspCapabilityInfo);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->assocRspAssociationId);
    packedLength += event_pack_CsrUint16(&buffer, connectionInfo->assocRspInfoElementsLength);
    if (connectionInfo->assocRspInfoElementsLength)
    {
        packedLength += event_pack_buffer(&buffer, connectionInfo->assocRspInfoElements, connectionInfo->assocRspInfoElementsLength);
    }
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)disassocReason);
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)deauthReason);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_mib_get_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status, CsrUint16 mibAttributeLength, const CsrUint8 *mibAttribute)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;
    packedSize += 2;
    if (mibAttributeLength)
    {
        packedSize += mibAttributeLength;
    }

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_MIB_GET_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);
    packedLength += event_pack_CsrUint16(&buffer, mibAttributeLength);
    if (mibAttributeLength)
    {
        packedLength += event_pack_buffer(&buffer, mibAttribute, mibAttributeLength);
    }

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_mib_get_next_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status, CsrUint16 mibAttributeLength, const CsrUint8 *mibAttribute)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;
    packedSize += 2;
    if (mibAttributeLength)
    {
        packedSize += mibAttributeLength;
    }

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_MIB_GET_NEXT_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);
    packedLength += event_pack_CsrUint16(&buffer, mibAttributeLength);
    if (mibAttributeLength)
    {
        packedLength += event_pack_buffer(&buffer, mibAttribute, mibAttributeLength);
    }

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_mib_set_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_MIB_SET_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_mic_failure_ind(CsrUint8** resultBuffer, CsrUint16 appHandlesCount, void* *appHandles, CsrBool secondFailure, CsrUint16 count, const unifi_MACAddress *address, unifi_KeyType keyType, CsrUint16 keyId, const CsrUint16 *tsc)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 2;
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedSize += 4;
        }
    }
    packedSize += 2;
    packedSize += 2;
    packedSize += 6;
    packedSize += 1;
    packedSize += 2;
    {
    CsrUint16 i1;
    for(i1 = 0; i1 < 4; i1++)
    {
        packedSize += 8;
    }
    }

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_MIC_FAILURE_IND_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, appHandlesCount);
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandles[i1]);
        }
    }
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)secondFailure);
    packedLength += event_pack_CsrUint16(&buffer, count);
    packedLength += event_pack_buffer(&buffer, address->data, 6);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)keyType);
    packedLength += event_pack_CsrUint16(&buffer, keyId);
    {
    CsrUint16 i1;
    for(i1 = 0; i1 < 4; i1++)
    {
        packedLength += event_pack_CsrUint16(&buffer, tsc[i1]);
    }
    }

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_multicast_address_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status, unifi_ListAction action, CsrUint8 getAddressesCount, const unifi_MACAddress *getAddresses)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;
    packedSize += 1;
    packedSize += 1;
    if (getAddressesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < getAddressesCount; i1++)
        {
            packedSize += 6;
        }
    }

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_MULTICAST_ADDRESS_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)action);
    packedLength += event_pack_CsrUint8(&buffer, getAddressesCount);
    if (getAddressesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < getAddressesCount; i1++)
        {
            packedLength += event_pack_buffer(&buffer, getAddresses[i1].data, 6);
        }
    }

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_packet_filter_set_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_PACKET_FILTER_SET_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_pmkid_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status, unifi_ListAction action, CsrUint8 getPmkidsCount, const unifi_Pmkid *getPmkids)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;
    packedSize += 1;
    packedSize += 1;
    if (getPmkidsCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < getPmkidsCount; i1++)
        {
            packedSize += 6;
            packedSize += 16;
        }
    }

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_PMKID_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)action);
    packedLength += event_pack_CsrUint8(&buffer, getPmkidsCount);
    if (getPmkidsCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < getPmkidsCount; i1++)
        {
            packedLength += event_pack_buffer(&buffer, getPmkids[i1].bssid.data, 6);
            packedLength += event_pack_buffer(&buffer, getPmkids[i1].pmkid, 16);
        }
    }

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_pmkid_candidate_list_ind(CsrUint8** resultBuffer, CsrUint16 appHandlesCount, void* *appHandles, CsrUint8 pmkidCandidatesCount, const unifi_PmkidCandidate *pmkidCandidates)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 2;
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedSize += 4;
        }
    }
    packedSize += 1;
    if (pmkidCandidatesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < pmkidCandidatesCount; i1++)
        {
            packedSize += 6;
            packedSize += 2;
        }
    }

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_PMKID_CANDIDATE_LIST_IND_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, appHandlesCount);
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandles[i1]);
        }
    }
    packedLength += event_pack_CsrUint8(&buffer, pmkidCandidatesCount);
    if (pmkidCandidatesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < pmkidCandidatesCount; i1++)
        {
            packedLength += event_pack_buffer(&buffer, pmkidCandidates[i1].bssid.data, 6);
            packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)pmkidCandidates[i1].preAuthAllowed);
        }
    }

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_profile_connect_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status, CsrUint8 connectAttemptsCount, const unifi_ConnectAttempt *connectAttempts)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;
    packedSize += 1;
    if (connectAttemptsCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < connectAttemptsCount; i1++)
        {
            packedSize += 6;
            packedSize += 1;
            packedSize += 1;
        }
    }

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_PROFILE_CONNECT_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);
    packedLength += event_pack_CsrUint8(&buffer, connectAttemptsCount);
    if (connectAttemptsCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < connectAttemptsCount; i1++)
        {
            packedLength += event_pack_buffer(&buffer, connectAttempts[i1].bssid.data, 6);
            packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)connectAttempts[i1].status);
            packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)connectAttempts[i1].securityError);
        }
    }

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_profile_delete_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_PROFILE_DELETE_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_profile_delete_all_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_PROFILE_DELETE_ALL_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_profile_disconnect_ind(CsrUint8** resultBuffer, CsrUint16 appHandlesCount, void* *appHandles, CsrUint8 connectAttemptsCount, const unifi_ConnectAttempt *connectAttempts)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 2;
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedSize += 4;
        }
    }
    packedSize += 1;
    if (connectAttemptsCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < connectAttemptsCount; i1++)
        {
            packedSize += 6;
            packedSize += 1;
            packedSize += 1;
        }
    }

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_PROFILE_DISCONNECT_IND_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, appHandlesCount);
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandles[i1]);
        }
    }
    packedLength += event_pack_CsrUint8(&buffer, connectAttemptsCount);
    if (connectAttemptsCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < connectAttemptsCount; i1++)
        {
            packedLength += event_pack_buffer(&buffer, connectAttempts[i1].bssid.data, 6);
            packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)connectAttempts[i1].status);
            packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)connectAttempts[i1].securityError);
        }
    }

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_profile_order_set_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_PROFILE_ORDER_SET_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_profile_set_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_PROFILE_SET_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_profile_update_ind(CsrUint8** resultBuffer, CsrUint16 appHandlesCount, void* *appHandles, const unifi_Profile *profile)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 2;
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedSize += 4;
        }
    }
    packedSize += 6;
    packedSize += 32;
    packedSize += 1;
    packedSize += 1;
    packedSize += 1;
    packedSize += 1;
    packedSize += 1;
    packedSize += 2;
    packedSize += 2;
    switch(profile->credentials.credentialType)
    {
    case unifi_CredentialTypeWpaPsk:
        packedSize += 2;
        packedSize += 32;
        break;
    case unifi_CredentialTypeOpenSystem:
        packedSize += 1;
        break;
    case unifi_CredentialTypeWapiPassphrase:
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.wapiPassphrase.passphrase) + 3);
        break;
    case unifi_CredentialType8021xLeap:
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.leap.username) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.leap.password) + 3);
        break;
    case unifi_CredentialTypeWpaPassphrase:
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.wpaPassphrase.passphrase) + 3);
        break;
    case unifi_CredentialType8021xPeapGtc:
        packedSize += 2;
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.peapGtc.authServerUserIdentity) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.peapGtc.username) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.peapGtc.password) + 3);
        packedSize += 4;
        if (profile->credentials.credential.peapGtc.sessionLength)
        {
            packedSize += profile->credentials.credential.peapGtc.sessionLength;
        }
        break;
    case unifi_CredentialType8021xTls:
        packedSize += 2;
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.tls.username) + 3);
        packedSize += 4;
        if (profile->credentials.credential.tls.certificateLength)
        {
            packedSize += profile->credentials.credential.tls.certificateLength;
        }
        packedSize += 2;
        if (profile->credentials.credential.tls.privateKeyLength)
        {
            packedSize += profile->credentials.credential.tls.privateKeyLength;
        }
        packedSize += 4;
        if (profile->credentials.credential.tls.sessionLength)
        {
            packedSize += profile->credentials.credential.tls.sessionLength;
        }
        break;
    case unifi_CredentialTypeWapiPsk:
        packedSize += 2;
        packedSize += 32;
        break;
    case unifi_CredentialTypeWep128:
        packedSize += 2;
        packedSize += 1;
        packedSize += 13;
        packedSize += 13;
        packedSize += 13;
        packedSize += 13;
        break;
    case unifi_CredentialTypeWep64:
        packedSize += 2;
        packedSize += 1;
        packedSize += 5;
        packedSize += 5;
        packedSize += 5;
        packedSize += 5;
        break;
    case unifi_CredentialType8021xFast:
        packedSize += 2;
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.fast.eapCredentials.authServerUserIdentity) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.fast.eapCredentials.username) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.fast.eapCredentials.password) + 3);
        packedSize += 4;
        if (profile->credentials.credential.fast.eapCredentials.sessionLength)
        {
            packedSize += profile->credentials.credential.fast.eapCredentials.sessionLength;
        }
        packedSize += 2;
        packedSize += 4;
        if (profile->credentials.credential.fast.pacLength)
        {
            packedSize += profile->credentials.credential.fast.pacLength;
        }
        break;
    case unifi_CredentialTypeWpa2Passphrase:
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.wpa2Passphrase.passphrase) + 3);
        break;
    case unifi_CredentialType8021xTtls:
        packedSize += 2;
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.ttls.authServerUserIdentity) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.ttls.username) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.ttls.password) + 3);
        packedSize += 4;
        if (profile->credentials.credential.ttls.sessionLength)
        {
            packedSize += profile->credentials.credential.ttls.sessionLength;
        }
        break;
    case unifi_CredentialTypeWpa2Psk:
        packedSize += 2;
        packedSize += 32;
        break;
    case unifi_CredentialTypeWapi:
        packedSize += 4;
        if (profile->credentials.credential.wapi.certificateLength)
        {
            packedSize += profile->credentials.credential.wapi.certificateLength;
        }
        packedSize += 2;
        if (profile->credentials.credential.wapi.privateKeyLength)
        {
            packedSize += profile->credentials.credential.wapi.privateKeyLength;
        }
        packedSize += 4;
        if (profile->credentials.credential.wapi.caCertificateLength)
        {
            packedSize += profile->credentials.credential.wapi.caCertificateLength;
        }
        break;
    case unifi_CredentialType8021xPeapMschapv2:
        packedSize += 2;
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.peapMsChapV2.authServerUserIdentity) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.peapMsChapV2.username) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.peapMsChapV2.password) + 3);
        packedSize += 4;
        if (profile->credentials.credential.peapMsChapV2.sessionLength)
        {
            packedSize += profile->credentials.credential.peapMsChapV2.sessionLength;
        }
        break;
    default:
        break;
    };

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_PROFILE_UPDATE_IND_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, appHandlesCount);
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandles[i1]);
        }
    }
    packedLength += event_pack_buffer(&buffer, profile->profileIdentity.bssid.data, 6);
    packedLength += event_pack_buffer(&buffer, profile->profileIdentity.ssid.ssid, 32);
    packedLength += event_pack_CsrUint8(&buffer, profile->profileIdentity.ssid.length);
    packedLength += event_pack_CsrUint8(&buffer, profile->wmmQosCapabilitiesMask);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)profile->bssType);
    packedLength += event_pack_CsrUint8(&buffer, profile->channelNo);
    packedLength += event_pack_CsrUint8(&buffer, profile->ccxOptionsMask);
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)profile->cloakedSsid);
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)profile->credentials.credentialType);
    switch(profile->credentials.credentialType)
    {
    case unifi_CredentialTypeWpaPsk:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.wpaPsk.encryptionMode);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wpaPsk.psk, 32);
        break;
    case unifi_CredentialTypeOpenSystem:
        packedLength += event_pack_CsrUint8(&buffer, profile->credentials.credential.openSystem.empty);
        break;
    case unifi_CredentialTypeWapiPassphrase:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.wapiPassphrase.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.wapiPassphrase.passphrase);
        break;
    case unifi_CredentialType8021xLeap:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.leap.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.leap.username);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.leap.password);
        break;
    case unifi_CredentialTypeWpaPassphrase:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.wpaPassphrase.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.wpaPassphrase.passphrase);
        break;
    case unifi_CredentialType8021xPeapGtc:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.peapGtc.authMode);
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.peapGtc.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.peapGtc.authServerUserIdentity);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.peapGtc.username);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.peapGtc.password);
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.peapGtc.sessionLength);
        if (profile->credentials.credential.peapGtc.sessionLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.peapGtc.session, profile->credentials.credential.peapGtc.sessionLength);
        }
        break;
    case unifi_CredentialType8021xTls:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.tls.authMode);
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.tls.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.tls.username);
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.tls.certificateLength);
        if (profile->credentials.credential.tls.certificateLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.tls.certificate, profile->credentials.credential.tls.certificateLength);
        }
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.tls.privateKeyLength);
        if (profile->credentials.credential.tls.privateKeyLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.tls.privateKey, profile->credentials.credential.tls.privateKeyLength);
        }
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.tls.sessionLength);
        if (profile->credentials.credential.tls.sessionLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.tls.session, profile->credentials.credential.tls.sessionLength);
        }
        break;
    case unifi_CredentialTypeWapiPsk:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.wapiPsk.encryptionMode);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wapiPsk.psk, 32);
        break;
    case unifi_CredentialTypeWep128:
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)profile->credentials.credential.wep128Key.wepAuthType);
        packedLength += event_pack_CsrUint8(&buffer, profile->credentials.credential.wep128Key.selectedWepKey);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep128Key.key1, 13);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep128Key.key2, 13);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep128Key.key3, 13);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep128Key.key4, 13);
        break;
    case unifi_CredentialTypeWep64:
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)profile->credentials.credential.wep64Key.wepAuthType);
        packedLength += event_pack_CsrUint8(&buffer, profile->credentials.credential.wep64Key.selectedWepKey);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep64Key.key1, 5);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep64Key.key2, 5);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep64Key.key3, 5);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep64Key.key4, 5);
        break;
    case unifi_CredentialType8021xFast:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.fast.eapCredentials.authMode);
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.fast.eapCredentials.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.fast.eapCredentials.authServerUserIdentity);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.fast.eapCredentials.username);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.fast.eapCredentials.password);
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.fast.eapCredentials.sessionLength);
        if (profile->credentials.credential.fast.eapCredentials.sessionLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.fast.eapCredentials.session, profile->credentials.credential.fast.eapCredentials.sessionLength);
        }
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)profile->credentials.credential.fast.allowPacProvisioning);
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.fast.pacLength);
        if (profile->credentials.credential.fast.pacLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.fast.pac, profile->credentials.credential.fast.pacLength);
        }
        break;
    case unifi_CredentialTypeWpa2Passphrase:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.wpa2Passphrase.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.wpa2Passphrase.passphrase);
        break;
    case unifi_CredentialType8021xTtls:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.ttls.authMode);
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.ttls.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.ttls.authServerUserIdentity);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.ttls.username);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.ttls.password);
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.ttls.sessionLength);
        if (profile->credentials.credential.ttls.sessionLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.ttls.session, profile->credentials.credential.ttls.sessionLength);
        }
        break;
    case unifi_CredentialTypeWpa2Psk:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.wpa2Psk.encryptionMode);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wpa2Psk.psk, 32);
        break;
    case unifi_CredentialTypeWapi:
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.wapi.certificateLength);
        if (profile->credentials.credential.wapi.certificateLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wapi.certificate, profile->credentials.credential.wapi.certificateLength);
        }
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.wapi.privateKeyLength);
        if (profile->credentials.credential.wapi.privateKeyLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wapi.privateKey, profile->credentials.credential.wapi.privateKeyLength);
        }
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.wapi.caCertificateLength);
        if (profile->credentials.credential.wapi.caCertificateLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wapi.caCertificate, profile->credentials.credential.wapi.caCertificateLength);
        }
        break;
    case unifi_CredentialType8021xPeapMschapv2:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.peapMsChapV2.authMode);
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.peapMsChapV2.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.peapMsChapV2.authServerUserIdentity);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.peapMsChapV2.username);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.peapMsChapV2.password);
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.peapMsChapV2.sessionLength);
        if (profile->credentials.credential.peapMsChapV2.sessionLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.peapMsChapV2.session, profile->credentials.credential.peapMsChapV2.sessionLength);
        }
        break;
    default:
        break;
    };

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_restricted_access_disable_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_RESTRICTED_ACCESS_DISABLE_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_restricted_access_enable_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_RESTRICTED_ACCESS_ENABLE_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_roam_complete_ind(CsrUint8** resultBuffer, CsrUint16 appHandlesCount, void* *appHandles, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 2;
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedSize += 4;
        }
    }
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_ROAM_COMPLETE_IND_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, appHandlesCount);
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandles[i1]);
        }
    }
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_roam_start_ind(CsrUint8** resultBuffer, CsrUint16 appHandlesCount, void* *appHandles, unifi_RoamReason roamReason, unifi_IEEE80211Reason reason80211)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 2;
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedSize += 4;
        }
    }
    packedSize += 1;
    packedSize += 2;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_ROAM_START_IND_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, appHandlesCount);
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandles[i1]);
        }
    }
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)roamReason);
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)reason80211);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_scan_full_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_SCAN_FULL_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_scan_result_ind(CsrUint8** resultBuffer, CsrUint16 appHandlesCount, void* *appHandles, const unifi_ScanResult *result)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 2;
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedSize += 4;
        }
    }
    packedSize += 32;
    packedSize += 1;
    packedSize += 6;
    packedSize += 2;
    packedSize += 2;
    packedSize += 1;
    packedSize += 2;
    packedSize += 8;
    packedSize += 8;
    packedSize += 2;
    packedSize += 2;
    packedSize += 1;
    packedSize += 1;
    packedSize += 1;
    packedSize += 2;
    if (result->informationElementsLength)
    {
        packedSize += result->informationElementsLength;
    }

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_SCAN_RESULT_IND_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, appHandlesCount);
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandles[i1]);
        }
    }
    packedLength += event_pack_buffer(&buffer, result->ssid.ssid, 32);
    packedLength += event_pack_CsrUint8(&buffer, result->ssid.length);
    packedLength += event_pack_buffer(&buffer, result->bssid.data, 6);
    packedLength += event_pack_CsrInt16(&buffer, result->rssi);
    packedLength += event_pack_CsrInt16(&buffer, result->snr);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)result->ifIndex);
    packedLength += event_pack_CsrUint16(&buffer, result->beaconPeriodTu);
    packedLength += event_pack_buffer(&buffer, result->timeStamp.data, 8);
    packedLength += event_pack_buffer(&buffer, result->localTime.data, 8);
    packedLength += event_pack_CsrUint16(&buffer, result->channelFrequency);
    packedLength += event_pack_CsrUint16(&buffer, result->capabilityInformation);
    packedLength += event_pack_CsrUint8(&buffer, result->channelNumber);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)result->usability);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)result->bssType);
    packedLength += event_pack_CsrUint16(&buffer, result->informationElementsLength);
    if (result->informationElementsLength)
    {
        packedLength += event_pack_buffer(&buffer, result->informationElements, result->informationElementsLength);
    }

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_scan_results_flush_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_SCAN_RESULTS_FLUSH_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_scan_results_get_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status, CsrUint16 scanResultsCount, const unifi_ScanResult *scanResults)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;
    packedSize += 2;
    if (scanResultsCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < scanResultsCount; i1++)
        {
            packedSize += 32;
            packedSize += 1;
            packedSize += 6;
            packedSize += 2;
            packedSize += 2;
            packedSize += 1;
            packedSize += 2;
            packedSize += 8;
            packedSize += 8;
            packedSize += 2;
            packedSize += 2;
            packedSize += 1;
            packedSize += 1;
            packedSize += 1;
            packedSize += 2;
            if (scanResults[i1].informationElementsLength)
            {
                packedSize += scanResults[i1].informationElementsLength;
            }
        }
    }

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_SCAN_RESULTS_GET_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);
    packedLength += event_pack_CsrUint16(&buffer, scanResultsCount);
    if (scanResultsCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < scanResultsCount; i1++)
        {
            packedLength += event_pack_buffer(&buffer, scanResults[i1].ssid.ssid, 32);
            packedLength += event_pack_CsrUint8(&buffer, scanResults[i1].ssid.length);
            packedLength += event_pack_buffer(&buffer, scanResults[i1].bssid.data, 6);
            packedLength += event_pack_CsrInt16(&buffer, scanResults[i1].rssi);
            packedLength += event_pack_CsrInt16(&buffer, scanResults[i1].snr);
            packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)scanResults[i1].ifIndex);
            packedLength += event_pack_CsrUint16(&buffer, scanResults[i1].beaconPeriodTu);
            packedLength += event_pack_buffer(&buffer, scanResults[i1].timeStamp.data, 8);
            packedLength += event_pack_buffer(&buffer, scanResults[i1].localTime.data, 8);
            packedLength += event_pack_CsrUint16(&buffer, scanResults[i1].channelFrequency);
            packedLength += event_pack_CsrUint16(&buffer, scanResults[i1].capabilityInformation);
            packedLength += event_pack_CsrUint8(&buffer, scanResults[i1].channelNumber);
            packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)scanResults[i1].usability);
            packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)scanResults[i1].bssType);
            packedLength += event_pack_CsrUint16(&buffer, scanResults[i1].informationElementsLength);
            if (scanResults[i1].informationElementsLength)
            {
                packedLength += event_pack_buffer(&buffer, scanResults[i1].informationElements, scanResults[i1].informationElementsLength);
            }
        }
    }

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_set_value_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status, unifi_AppValueId appValueId)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_SET_VALUE_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)appValueId);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_tspec_ind(CsrUint8** resultBuffer, CsrUint16 appHandlesCount, void* *appHandles, CsrUint32 transactionId, unifi_TspecResultCode tspecResultCode, CsrUint16 tspecLength, const CsrUint8 *tspec)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 2;
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedSize += 4;
        }
    }
    packedSize += 4;
    packedSize += 1;
    packedSize += 2;
    if (tspecLength)
    {
        packedSize += tspecLength;
    }

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_TSPEC_IND_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, appHandlesCount);
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandles[i1]);
        }
    }
    packedLength += event_pack_CsrUint32(&buffer, transactionId);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)tspecResultCode);
    packedLength += event_pack_CsrUint16(&buffer, tspecLength);
    if (tspecLength)
    {
        packedLength += event_pack_buffer(&buffer, tspec, tspecLength);
    }

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_tspec_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status, CsrUint32 transactionId, unifi_TspecResultCode tspecResultCode, CsrUint16 tspecLength, const CsrUint8 *tspec)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;
    packedSize += 4;
    packedSize += 1;
    packedSize += 2;
    if (tspecLength)
    {
        packedSize += tspecLength;
    }

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_TSPEC_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);
    packedLength += event_pack_CsrUint32(&buffer, transactionId);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)tspecResultCode);
    packedLength += event_pack_CsrUint16(&buffer, tspecLength);
    if (tspecLength)
    {
        packedLength += event_pack_buffer(&buffer, tspec, tspecLength);
    }

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_wifi_flightmode_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_WIFI_FLIGHTMODE_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_wifi_off_ind(CsrUint8** resultBuffer, CsrUint16 appHandlesCount, void* *appHandles, unifi_ControlIndication controlIndication)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 2;
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedSize += 4;
        }
    }
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_WIFI_OFF_IND_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, appHandlesCount);
    if (appHandlesCount)
    {
        CsrUint16 i1;
        for(i1 = 0; i1 < appHandlesCount; i1++)
        {
            packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandles[i1]);
        }
    }
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)controlIndication);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_wifi_off_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_WIFI_OFF_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_wifi_on_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_WIFI_ON_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_wps_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status, const unifi_Profile *profile)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;
    packedSize += 6;
    packedSize += 32;
    packedSize += 1;
    packedSize += 1;
    packedSize += 1;
    packedSize += 1;
    packedSize += 1;
    packedSize += 2;
    packedSize += 2;
    switch(profile->credentials.credentialType)
    {
    case unifi_CredentialTypeWpaPsk:
        packedSize += 2;
        packedSize += 32;
        break;
    case unifi_CredentialTypeOpenSystem:
        packedSize += 1;
        break;
    case unifi_CredentialTypeWapiPassphrase:
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.wapiPassphrase.passphrase) + 3);
        break;
    case unifi_CredentialType8021xLeap:
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.leap.username) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.leap.password) + 3);
        break;
    case unifi_CredentialTypeWpaPassphrase:
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.wpaPassphrase.passphrase) + 3);
        break;
    case unifi_CredentialType8021xPeapGtc:
        packedSize += 2;
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.peapGtc.authServerUserIdentity) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.peapGtc.username) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.peapGtc.password) + 3);
        packedSize += 4;
        if (profile->credentials.credential.peapGtc.sessionLength)
        {
            packedSize += profile->credentials.credential.peapGtc.sessionLength;
        }
        break;
    case unifi_CredentialType8021xTls:
        packedSize += 2;
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.tls.username) + 3);
        packedSize += 4;
        if (profile->credentials.credential.tls.certificateLength)
        {
            packedSize += profile->credentials.credential.tls.certificateLength;
        }
        packedSize += 2;
        if (profile->credentials.credential.tls.privateKeyLength)
        {
            packedSize += profile->credentials.credential.tls.privateKeyLength;
        }
        packedSize += 4;
        if (profile->credentials.credential.tls.sessionLength)
        {
            packedSize += profile->credentials.credential.tls.sessionLength;
        }
        break;
    case unifi_CredentialTypeWapiPsk:
        packedSize += 2;
        packedSize += 32;
        break;
    case unifi_CredentialTypeWep128:
        packedSize += 2;
        packedSize += 1;
        packedSize += 13;
        packedSize += 13;
        packedSize += 13;
        packedSize += 13;
        break;
    case unifi_CredentialTypeWep64:
        packedSize += 2;
        packedSize += 1;
        packedSize += 5;
        packedSize += 5;
        packedSize += 5;
        packedSize += 5;
        break;
    case unifi_CredentialType8021xFast:
        packedSize += 2;
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.fast.eapCredentials.authServerUserIdentity) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.fast.eapCredentials.username) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.fast.eapCredentials.password) + 3);
        packedSize += 4;
        if (profile->credentials.credential.fast.eapCredentials.sessionLength)
        {
            packedSize += profile->credentials.credential.fast.eapCredentials.sessionLength;
        }
        packedSize += 2;
        packedSize += 4;
        if (profile->credentials.credential.fast.pacLength)
        {
            packedSize += profile->credentials.credential.fast.pacLength;
        }
        break;
    case unifi_CredentialTypeWpa2Passphrase:
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.wpa2Passphrase.passphrase) + 3);
        break;
    case unifi_CredentialType8021xTtls:
        packedSize += 2;
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.ttls.authServerUserIdentity) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.ttls.username) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.ttls.password) + 3);
        packedSize += 4;
        if (profile->credentials.credential.ttls.sessionLength)
        {
            packedSize += profile->credentials.credential.ttls.sessionLength;
        }
        break;
    case unifi_CredentialTypeWpa2Psk:
        packedSize += 2;
        packedSize += 32;
        break;
    case unifi_CredentialTypeWapi:
        packedSize += 4;
        if (profile->credentials.credential.wapi.certificateLength)
        {
            packedSize += profile->credentials.credential.wapi.certificateLength;
        }
        packedSize += 2;
        if (profile->credentials.credential.wapi.privateKeyLength)
        {
            packedSize += profile->credentials.credential.wapi.privateKeyLength;
        }
        packedSize += 4;
        if (profile->credentials.credential.wapi.caCertificateLength)
        {
            packedSize += profile->credentials.credential.wapi.caCertificateLength;
        }
        break;
    case unifi_CredentialType8021xPeapMschapv2:
        packedSize += 2;
        packedSize += 2;
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.peapMsChapV2.authServerUserIdentity) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.peapMsChapV2.username) + 3);
        packedSize += (CsrUint16)(CsrStrLen(profile->credentials.credential.peapMsChapV2.password) + 3);
        packedSize += 4;
        if (profile->credentials.credential.peapMsChapV2.sessionLength)
        {
            packedSize += profile->credentials.credential.peapMsChapV2.sessionLength;
        }
        break;
    default:
        break;
    };

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_WPS_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);
    packedLength += event_pack_buffer(&buffer, profile->profileIdentity.bssid.data, 6);
    packedLength += event_pack_buffer(&buffer, profile->profileIdentity.ssid.ssid, 32);
    packedLength += event_pack_CsrUint8(&buffer, profile->profileIdentity.ssid.length);
    packedLength += event_pack_CsrUint8(&buffer, profile->wmmQosCapabilitiesMask);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)profile->bssType);
    packedLength += event_pack_CsrUint8(&buffer, profile->channelNo);
    packedLength += event_pack_CsrUint8(&buffer, profile->ccxOptionsMask);
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)profile->cloakedSsid);
    packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)profile->credentials.credentialType);
    switch(profile->credentials.credentialType)
    {
    case unifi_CredentialTypeWpaPsk:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.wpaPsk.encryptionMode);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wpaPsk.psk, 32);
        break;
    case unifi_CredentialTypeOpenSystem:
        packedLength += event_pack_CsrUint8(&buffer, profile->credentials.credential.openSystem.empty);
        break;
    case unifi_CredentialTypeWapiPassphrase:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.wapiPassphrase.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.wapiPassphrase.passphrase);
        break;
    case unifi_CredentialType8021xLeap:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.leap.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.leap.username);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.leap.password);
        break;
    case unifi_CredentialTypeWpaPassphrase:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.wpaPassphrase.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.wpaPassphrase.passphrase);
        break;
    case unifi_CredentialType8021xPeapGtc:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.peapGtc.authMode);
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.peapGtc.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.peapGtc.authServerUserIdentity);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.peapGtc.username);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.peapGtc.password);
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.peapGtc.sessionLength);
        if (profile->credentials.credential.peapGtc.sessionLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.peapGtc.session, profile->credentials.credential.peapGtc.sessionLength);
        }
        break;
    case unifi_CredentialType8021xTls:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.tls.authMode);
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.tls.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.tls.username);
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.tls.certificateLength);
        if (profile->credentials.credential.tls.certificateLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.tls.certificate, profile->credentials.credential.tls.certificateLength);
        }
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.tls.privateKeyLength);
        if (profile->credentials.credential.tls.privateKeyLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.tls.privateKey, profile->credentials.credential.tls.privateKeyLength);
        }
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.tls.sessionLength);
        if (profile->credentials.credential.tls.sessionLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.tls.session, profile->credentials.credential.tls.sessionLength);
        }
        break;
    case unifi_CredentialTypeWapiPsk:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.wapiPsk.encryptionMode);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wapiPsk.psk, 32);
        break;
    case unifi_CredentialTypeWep128:
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)profile->credentials.credential.wep128Key.wepAuthType);
        packedLength += event_pack_CsrUint8(&buffer, profile->credentials.credential.wep128Key.selectedWepKey);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep128Key.key1, 13);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep128Key.key2, 13);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep128Key.key3, 13);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep128Key.key4, 13);
        break;
    case unifi_CredentialTypeWep64:
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)profile->credentials.credential.wep64Key.wepAuthType);
        packedLength += event_pack_CsrUint8(&buffer, profile->credentials.credential.wep64Key.selectedWepKey);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep64Key.key1, 5);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep64Key.key2, 5);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep64Key.key3, 5);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wep64Key.key4, 5);
        break;
    case unifi_CredentialType8021xFast:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.fast.eapCredentials.authMode);
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.fast.eapCredentials.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.fast.eapCredentials.authServerUserIdentity);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.fast.eapCredentials.username);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.fast.eapCredentials.password);
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.fast.eapCredentials.sessionLength);
        if (profile->credentials.credential.fast.eapCredentials.sessionLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.fast.eapCredentials.session, profile->credentials.credential.fast.eapCredentials.sessionLength);
        }
        packedLength += event_pack_CsrUint16(&buffer, (CsrUint16)profile->credentials.credential.fast.allowPacProvisioning);
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.fast.pacLength);
        if (profile->credentials.credential.fast.pacLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.fast.pac, profile->credentials.credential.fast.pacLength);
        }
        break;
    case unifi_CredentialTypeWpa2Passphrase:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.wpa2Passphrase.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.wpa2Passphrase.passphrase);
        break;
    case unifi_CredentialType8021xTtls:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.ttls.authMode);
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.ttls.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.ttls.authServerUserIdentity);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.ttls.username);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.ttls.password);
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.ttls.sessionLength);
        if (profile->credentials.credential.ttls.sessionLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.ttls.session, profile->credentials.credential.ttls.sessionLength);
        }
        break;
    case unifi_CredentialTypeWpa2Psk:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.wpa2Psk.encryptionMode);
        packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wpa2Psk.psk, 32);
        break;
    case unifi_CredentialTypeWapi:
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.wapi.certificateLength);
        if (profile->credentials.credential.wapi.certificateLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wapi.certificate, profile->credentials.credential.wapi.certificateLength);
        }
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.wapi.privateKeyLength);
        if (profile->credentials.credential.wapi.privateKeyLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wapi.privateKey, profile->credentials.credential.wapi.privateKeyLength);
        }
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.wapi.caCertificateLength);
        if (profile->credentials.credential.wapi.caCertificateLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.wapi.caCertificate, profile->credentials.credential.wapi.caCertificateLength);
        }
        break;
    case unifi_CredentialType8021xPeapMschapv2:
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.peapMsChapV2.authMode);
        packedLength += event_pack_CsrUint16(&buffer, profile->credentials.credential.peapMsChapV2.encryptionMode);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.peapMsChapV2.authServerUserIdentity);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.peapMsChapV2.username);
        packedLength += event_pack_string(&buffer, profile->credentials.credential.peapMsChapV2.password);
        packedLength += event_pack_CsrUint32(&buffer, profile->credentials.credential.peapMsChapV2.sessionLength);
        if (profile->credentials.credential.peapMsChapV2.sessionLength)
        {
            packedLength += event_pack_buffer(&buffer, profile->credentials.credential.peapMsChapV2.session, profile->credentials.credential.peapMsChapV2.sessionLength);
        }
        break;
    default:
        break;
    };

    *resultBuffer = evt;
    return packedLength;
}

CsrUint16 serialise_unifi_nme_wps_cancel_cfm(CsrUint8** resultBuffer, void* appHandle, unifi_Status status)
{
    CsrUint16 packedLength = 0;
    CsrUint32 packedSize = 6;
    CsrUint8* evt;
    CsrUint8* buffer;

    /* Calc Dymanic Size */
    packedSize += 4;
    packedSize += 1;

    evt = (CsrUint8*)CsrPmalloc(packedSize);
    buffer = evt;
    packedLength += event_pack_CsrUint16(&buffer, UNIFI_NME_WPS_CANCEL_CFM_ID);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint16(&buffer, 0);
    packedLength += event_pack_CsrUint32(&buffer, (CsrUint32)appHandle);
    packedLength += event_pack_CsrUint8(&buffer, (CsrUint8)status);

    *resultBuffer = evt;
    return packedLength;
}


